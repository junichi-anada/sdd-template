# SDD フロー（仕様駆動開発）

本テンプレートの開発ライフサイクルは次の順序に固定されます。

1. 仕様（Spec）: ユーザーがタイトルと概要を提示 → エージェントが `specs/` にドラフト作成 → ユーザー承認で確定。
2. 計画（Plan）: 確定した仕様に基づき `plans/` にドラフト作成 → ユーザー承認で確定。
3. テスト（Tests）: 計画に基づき `tests/` に作成（先に失敗させる）。
4. 実装（Code）: テストをグリーンにする最小実装 → リファクタリング。
5. 検証（Verify）: ローカル/CI でテストを実行し品質ゲートを通す。

## 承認ゲート
- Spec 承認がなければ Plan/Tests/Code に進まない。
- Plan 承認がなければ Code に進まない。
- PR では Spec/Plan 承認と Tests を必須チェック。

## 実務ルール
- 余計な変更はしない（差分最小）。
- エッジケースと失敗モードを明記し、テストに反映する。
- Laravel 初期化は `make init`（Composer 必須）。
 - テンプレート自身の改善（メタ変更）は専用命名を使用し、通常機能と区別する。

### メタ変更ルール
- コマンド: `make spec TITLE='meta: <仕様の内容>'`
- ファイル名: `meta-<slug>-<stamp>.md` を先頭 `meta-` で統一（通常Specは `<stamp>-<slug>.md`）。
	- 例外: slug が `meta` のみの場合は `meta-<stamp>.md` に縮約（冗長な `meta-meta` を避ける）。
- 旧形式 `meta=` で既存に残るファイルはレガシーとして保持（リネーム不要）。
- PR テンプレートにメタ変更チェックを追加（Spec/Plan/テスト方針必須）。

## 典型的なコマンド
- 初期化: `make init`
- 仕様ドラフト作成: `make spec TITLE='ユーザ登録機能'`
- 計画ドラフト作成: `make plan TITLE='ユーザ登録のバックエンド実装'`
- テスト実行: `make test`

## CI
- `composer.json` がある場合のみ PHP テストを実行。

