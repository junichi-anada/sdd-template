# Plan: meta: テンプレート改善SDD遵守と命名規則の実装計画

## 方針
- アーキテクチャ/設計方針:
	- 変更範囲は最小・局所（生成スクリプト `scripts/gen.sh` のみ、README/docs/PRテンプレのドキュメント追記）。
	- 振る舞い切替は“TITLEが`meta:`で始まる AND TYPEがspec”のとき限定。
	- ファイル名は `meta-<SLUG>-<STAMP>.md` とし、既存の `STAMP-<SLUG>.md` には非影響。
	- 移行方針: 旧形式（`meta=` 起票済みSpec）は履歴保持のため手動リネーム不要。新規のみ `meta:` + `meta-` を強制、旧形式はレガシー表記として docs に注記。
- データモデル/スキーマ:
- インターフェース/API:
	- CLIインターフェースは現行維持（`make spec TITLE='...'`）。
	- メタ仕様の場合のみ `TITLE='meta: ...'` を要求、READMEとdocsに明記。

## タスク分解（SDD順序）
1) 仕様確定（承認）
2) テスト設計（受け入れ基準に対応）
3) 実装（テストをグリーンに）
4) リファクタリングと観測性の追加
5) セキュリティ/パフォーマンス確認

## 具体タスク
| ID | 種別(SPEC/TEST/CODE/OPS) | 内容 | 完了条件 |
|----|--------------------------|------|----------|
| T-1 | TEST | 静的検証スクリプト（簡易）: `make spec TITLE='meta: abc'` 実行で `specs/meta-<slug>-<stamp>.md` ができることをチェック（スクリプト名は固定で `tests/meta_spec_generation.sh`） | ローカルでシェルスクリプトを実行し非0終了（失敗）から成功へ |
| T-2 | CODE | `scripts/gen.sh` を修正：`TYPE=spec` かつ `TITLE` が `meta:` 始まりなら `TARGET_FILE` を `meta-<SLUG>-<STAMP>.md` に変更 | `make spec TITLE='meta: test'` で期待パスが生成 |
| T-3 | CODE | `README.md` と `docs/sdd-flow.md` に metaルールと手順追記（旧 `meta=` はレガシーとして保持） | 差分確認で記載反映 |
| T-4 | CODE | `.github/pull_request_template.md` を新規作成（または更新）しメタ用チェックリストを追加 | PR作成画面でチェック項目表示 |
| T-5 | TEST | 生成物ファイル名とタイトルの一貫性（先頭 `meta-`、タイトル先頭 `meta:`）の確認 | 2ケース（meta: あり/なし）で手動・自動チェック通過 |
| T-6 | OPS | 運用ガイドの軽微修正例外のメモ（誤字等はPRテンプレのみでOK）をdocsに追記 | docs更新が確認できる |
| T-7 | OPS | 旧形式（`meta=`）は履歴保持・リネーム不要、今後は `meta:` 利用を明記 | 記載が確認できる |

## スケジュール
- 着手: 2025-11-13
- 完了予定: 2025-11-13

## リスク/ブロッカー
- 既存の自動生成に依存した外部ツールがタイムスタンプ起点を前提にしている可能性（低）。→ メタSpecに限定するため影響限定、必要なら互換オプション検討。

## 承認
- Plan 作成者: Copilot
- レビュー: Owner
- 承認日時: 2025-11-13T00:00:00+09:00
- ステータス: APPROVED
